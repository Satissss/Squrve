# [Question]: Can you provide the number of distinct active and closed bike share stations for each year 2013 and 2014?
# [Schema links]: [bikeshare_trips.start_time, bikeshare_trips.start_station_id, bikeshare_stations.status, bikeshare_stations.station_id]
# [Analysis]: Letâ€™s think step by step.
1. Identify the relevant tables and columns: `bikeshare_trips` (start_time, start_station_id) and `bikeshare_stations` (station_id, status).
2. Extract the year from `start_time` in `bikeshare_trips` to group data by 2013 and 2014.
3. Join `bikeshare_trips` and `bikeshare_stations` on `start_station_id` and `station_id` to link trips with station status.
4. Create a derived table to extract year and start_station_id from trips for filtering years 2013-2014.
5. Use CASE expressions to conditionally calculate COUNT(DISTINCT station_id) for active and closed statuses per year using subqueries.
6. Filter the derived table to include only years 2013 and 2014 with WHERE t.year BETWEEN 2013 AND 2014.
7. Group results by year to aggregate counts and order the final output by year.
# [Sql]: SELECT     t.year,     CASE          WHEN t.year = 2013 THEN (                                   SELECT                                      COUNT(DISTINCT station_id)                                   FROM                                      `bigquery-public-data.austin_bikeshare.bikeshare_trips` t                                   INNER JOIN                                      `bigquery-public-data.austin_bikeshare.bikeshare_stations` s                                   ON                                      t.start_station_id = s.station_id                                   WHERE                                      s.status = 'active' AND EXTRACT(YEAR FROM start_time) = 2013                                  )          WHEN t.year = 2014 THEN (                                   SELECT                                      COUNT(DISTINCT station_id)                                   FROM                                      `bigquery-public-data.austin_bikeshare.bikeshare_trips` t                                   INNER JOIN                                      `bigquery-public-data.austin_bikeshare.bikeshare_stations` s                                   ON                                      t.start_station_id = s.station_id                                   WHERE                                      s.status = 'active' AND EXTRACT(YEAR FROM start_time) = 2014                                  )     END     AS number_status_active,     CASE          WHEN t.year = 2013 THEN (                                   SELECT                                     COUNT(DISTINCT station_id)                                   FROM                                    `bigquery-public-data.austin_bikeshare.bikeshare_trips` t                                   INNER JOIN                                    `bigquery-public-data.austin_bikeshare.bikeshare_stations` s                                   ON                                     t.start_station_id = s.station_id                                   WHERE                                     s.status = 'closed' AND EXTRACT(YEAR FROM start_time) = 2013                                  )          WHEN t.year = 2014 THEN (                                   SELECT                                    COUNT(DISTINCT station_id)                                   FROM                                      `bigquery-public-data.austin_bikeshare.bikeshare_trips` t                                   INNER JOIN                                      `bigquery-public-data.austin_bikeshare.bikeshare_stations` s                                   ON                                      t.start_station_id = s.station_id                                   WHERE                                      s.status = 'closed' AND EXTRACT(YEAR FROM start_time) = 2014                                  )     END     AS number_status_closed FROM     (       SELECT           EXTRACT(YEAR FROM start_time) AS year,          start_station_id       FROM          `bigquery-public-data.austin_bikeshare.bikeshare_trips`     )      AS t INNER JOIN     `bigquery-public-data.austin_bikeshare.bikeshare_stations` s ON     t.start_station_id = s.station_id WHERE     t.year BETWEEN 2013 AND 2014 GROUP BY     t.year ORDER BY     t.year