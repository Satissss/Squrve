# [Question]: Could you provide the percentage of participants for standard acne, atopic dermatitis, psoriasis, and vitiligo as defined by the International Classification of Diseases 10-CM (ICD-10-CM), including their subcategories? Please include all related concepts mapped to the standard ICD-10-CM codes (L70 for acne, L20 for atopic dermatitis, L40 for psoriasis, and L80 for vitiligo) by utilizing concept relationships, including descendant concepts. The percentage should be calculated based on the total number of participants, considering only the standard concepts and their related descendants.
# [Schema links]: ["concept.concept_id", "concept.concept_code", "concept_relationship.concept_id_1", "concept_relationship.concept_id_2", "concept_relationship.relationship_id", "concept.standard_concept", "concept_ancestor.ancestor_concept_id", "concept_ancestor.descendant_concept_id", "condition_occurrence.condition_concept_id", "condition_occurrence.person_id", "person.person_id"]
# [Analysis]: Letâ€™s think step by step.
1. Identify the main ICD-10-CM codes (L70, L20, L40, L80) and their corresponding skin condition names using the `concept` table.
2. Retrieve standard concepts mapped via 'Maps to' relationships in `concept_relationship` where `standard_concept` is 'S'.
3. Collect all descendant concepts of the standard concepts using `concept_ancestor` to include subcategories.
4. Count distinct participants per skin condition by joining `condition_occurrence` with descendant concept IDs.
5. Calculate total participants by counting distinct `person_id` from the `person` table.
6. Compute the percentage for each condition by dividing its participant count by the total participants.
7. Combine results using the calculated percentages and order by skin condition name.
# [Sql]: WITH skin_condition_ICD_concept_ids AS (    SELECT         concept_id,         CASE concept_code             WHEN 'L70' THEN 'Acne'             WHEN 'L20' THEN 'Atopic dermatitis'             WHEN 'L40' THEN 'Psoriasis'             ELSE 'Vitiligo'         END AS skin_condition     FROM         `bigquery-public-data.cms_synthetic_patient_data_omop.concept`     WHERE         concept_code IN ('L70', 'L20', 'L40', 'L80')), skin_condition_standard_concept_ids AS (    SELECT         s.skin_condition,         r.concept_id_2 AS concept_id     FROM         skin_condition_ICD_concept_ids s     JOIN         `bigquery-public-data.cms_synthetic_patient_data_omop.concept_relationship` r     ON         s.concept_id = r.concept_id_1     JOIN         `bigquery-public-data.cms_synthetic_patient_data_omop.concept` c     ON         r.concept_id_2 = c.concept_id     WHERE         r.relationship_id = 'Maps to'         AND c.standard_concept = 'S'), all_skin_concept_ids AS (    SELECT DISTINCT         skin_condition,         concept_id     FROM         skin_condition_standard_concept_ids), descendant_concept_ids AS (    SELECT         a.skin_condition,         ca.descendant_concept_id AS concept_id     FROM         all_skin_concept_ids a     JOIN         `bigquery-public-data.cms_synthetic_patient_data_omop.concept_ancestor` ca     ON         a.concept_id = ca.ancestor_concept_id), participants_with_condition AS (    SELECT         d.skin_condition,         COUNT(DISTINCT co.person_id) AS nb_participants     FROM         `bigquery-public-data.cms_synthetic_patient_data_omop.condition_occurrence` co     JOIN         descendant_concept_ids d     ON         co.condition_concept_id = d.concept_id     GROUP BY         d.skin_condition), total_participants AS (    SELECT         COUNT(DISTINCT person_id) AS total     FROM         `bigquery-public-data.cms_synthetic_patient_data_omop.person`) SELECT     p.skin_condition,     100.0 * p.nb_participants / t.total AS percentage_of_participants FROM     participants_with_condition p CROSS JOIN     total_participants t ORDER BY     p.skin_condition;