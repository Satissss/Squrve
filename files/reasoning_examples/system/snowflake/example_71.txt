# [Question]: Which top five histological types of breast cancer (BRCA) in the PanCancer Atlas exhibit the highest percentage of CDH1 gene mutations?
# [Schema links]: ["PANCANCER_ATLAS_FILTERED.CLINICAL_PANCAN_PATIENT_WITH_FOLLOWUP_FILTERED.histological_type", "PANCANCER_ATLAS_FILTERED.CLINICAL_PANCAN_PATIENT_WITH_FOLLOWUP_FILTERED.bcr_patient_barcode", "PANCANCER_ATLAS_FILTERED.CLINICAL_PANCAN_PATIENT_WITH_FOLLOWUP_FILTERED.acronym", "PANCANCER_ATLAS_FILTERED.MC3_MAF_V5_ONE_PER_TUMOR_SAMPLE.Hugo_Symbol", "PANCANCER_ATLAS_FILTERED.MC3_MAF_V5_ONE_PER_TUMOR_SAMPLE.ParticipantBarcode", "PANCANCER_ATLAS_FILTERED.MC3_MAF_V5_ONE_PER_TUMOR_SAMPLE.Study", "PANCANCER_ATLAS_FILTERED.MC3_MAF_V5_ONE_PER_TUMOR_SAMPLE.FILTER"]
# [Analysis]: Let’s think step by step.
1. Identify the relevant tables: `CLINICAL_PANCAN_PATIENT_WITH_FOLLOWUP_FILTERED` (for histological_type and BRCA patients) and `MC3_MAF_V5_ONE_PER_TUMOR_SAMPLE` (for CDH1 mutations).
2. Filter clinical data to include only BRCA patients with non-null histological types, selecting histological_type and ParticipantBarcode.
3. Filter mutation data to include only BRCA study entries with Hugo_Symbol 'CDH1' and FILTER 'PASS', grouping by ParticipantBarcode.
4. Perform a LEFT JOIN between clinical and mutation data on ParticipantBarcode to关联患者与突变状态.
5. Calculate mutation presence (YES/NO) and count occurrences per histological type and mutation status.
6. Compute mutation counts, total patients, and mutation percentages per histological type.
7. Rank histological types by mutation_percentage in descending order and select the top 5.
# [Sql]: WITH     table1 AS (         SELECT             "histological_type" AS "data1",             "bcr_patient_barcode" AS "ParticipantBarcode"         FROM              "PANCANCER_ATLAS_1"."PANCANCER_ATLAS_FILTERED"."CLINICAL_PANCAN_PATIENT_WITH_FOLLOWUP_FILTERED"         WHERE              "acronym" = 'BRCA'              AND "histological_type" IS NOT NULL           ),     table2 AS (         SELECT             "Hugo_Symbol" AS "symbol",              "ParticipantBarcode"         FROM              "PANCANCER_ATLAS_1"."PANCANCER_ATLAS_FILTERED"."MC3_MAF_V5_ONE_PER_TUMOR_SAMPLE"         WHERE              "Study" = 'BRCA'              AND "Hugo_Symbol" = 'CDH1'             AND "FILTER" = 'PASS'           GROUP BY             "ParticipantBarcode", "symbol"     ),     summ_table AS (         SELECT              n1."data1",             CASE                  WHEN n2."ParticipantBarcode" IS NULL THEN 'NO'                  ELSE 'YES'              END AS "data2",             COUNT(*) AS "Nij"         FROM             table1 AS n1         LEFT JOIN             table2 AS n2              ON n1."ParticipantBarcode" = n2."ParticipantBarcode"         GROUP BY             n1."data1", "data2"     ),     percentages AS (         SELECT             "data1",             SUM(CASE WHEN "data2" = 'YES' THEN "Nij" ELSE 0 END) AS "mutation_count",             SUM("Nij") AS "total",             SUM(CASE WHEN "data2" = 'YES' THEN "Nij" ELSE 0 END) / SUM("Nij") AS "mutation_percentage"         FROM              summ_table         GROUP BY              "data1"     ) SELECT      "data1" AS "Histological_Type" FROM      percentages ORDER BY      "mutation_percentage" DESC LIMIT 5;