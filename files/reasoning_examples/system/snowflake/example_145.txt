# [Question]: In the TCGA-BRCA cohort of patients who are 80 years old or younger at diagnosis and have a pathological stage of Stage I, Stage II, or Stage IIA, calculate the t-statistic derived from the Pearson correlation between the log10-transformed average RNA-Seq expression levels (using HTSeq__Counts + 1) of the gene SNORA31 and the average microRNA-Seq expression levels of all unique microRNAs, only considering pairs with more than 25 samples and where the absolute Pearson correlation coefficient is between 0.3 and 1.0
# [Schema links]: ["TCGA_BIOCLIN_V0.CLINICAL.case_barcode", "TCGA_BIOCLIN_V0.CLINICAL.project_short_name", "TCGA_BIOCLIN_V0.CLINICAL.age_at_diagnosis", "TCGA_BIOCLIN_V0.CLINICAL.pathologic_stage", "TCGA_HG38_DATA_V0.RNASEQ_GENE_EXPRESSION.gene_name", "TCGA_HG38_DATA_V0.RNASEQ_GENE_EXPRESSION.HTSeq__Counts", "TCGA_HG38_DATA_V0.RNASEQ_GENE_EXPRESSION.case_barcode", "TCGA_HG38_DATA_V0.MIRNASEQ_EXPRESSION.mirna_id", "TCGA_HG38_DATA_V0.MIRNASEQ_EXPRESSION.reads_per_million_miRNA_mapped", "TCGA_HG38_DATA_V0.MIRNASEQ_EXPRESSION.case_barcode"]
# [Analysis]: Let’s think step by step.
1. Identify the clinical cohort by selecting case_barcodes from TCGA-BRCA patients ≤80 years old with pathologic stages I, II, or IIA using the CLINICAL table.
2. Create a CTE (table1) for SNORA31 gene expression: calculate log10(HTSeq__Counts +1) averaged across qualified cases, filtering for gene_name 'SNORA31'.
3. Create a CTE (table2) for miRNA expressions: calculate average reads_per_million_miRNA_mapped values for each miRNA across qualified cases, excluding null values.
4. Join table1 and table2 on ParticipantBarcode to align expression data for the same cases, calculating Pearson correlation coefficients between SNORA31 and each miRNA.
5. Compute the t-statistic using the formula: t = ABS(correlation) * SQRT((n-2)/(1 - correlation²)) for each miRNA-SNORA31 pair.
6. Apply filtering criteria: require n>25 samples and absolute correlation between 0.3 and 1.0 before returning results.
# [Sql]: WITH cohort AS (     SELECT "case_barcode"     FROM "TCGA_HG38_DATA_V0"."TCGA_BIOCLIN_V0"."CLINICAL"     WHERE "project_short_name" = 'TCGA-BRCA'         AND "age_at_diagnosis" <= 80         AND "pathologic_stage" IN ('Stage I', 'Stage II', 'Stage IIA') ), table1 AS (     SELECT         "symbol",         "data" AS "rnkdata",         "ParticipantBarcode"     FROM (         SELECT             "gene_name" AS "symbol",              AVG(LOG(10, "HTSeq__Counts" + 1)) AS "data",             "case_barcode" AS "ParticipantBarcode"         FROM "TCGA_HG38_DATA_V0"."TCGA_HG38_DATA_V0"."RNASEQ_GENE_EXPRESSION"         WHERE "case_barcode" IN (SELECT "case_barcode" FROM cohort)             AND "gene_name" = 'SNORA31'             AND "HTSeq__Counts" IS NOT NULL         GROUP BY             "ParticipantBarcode", "symbol"     ) ), table2 AS (     SELECT         "symbol",         "data" AS "rnkdata",         "ParticipantBarcode"     FROM (         SELECT             "mirna_id" AS "symbol",              AVG("reads_per_million_miRNA_mapped") AS "data",             "case_barcode" AS "ParticipantBarcode"         FROM "TCGA_HG38_DATA_V0"."TCGA_HG38_DATA_V0"."MIRNASEQ_EXPRESSION"         WHERE "case_barcode" IN (SELECT "case_barcode" FROM cohort)             AND "mirna_id" IS NOT NULL             AND "reads_per_million_miRNA_mapped" IS NOT NULL         GROUP BY             "ParticipantBarcode", "symbol"     ) ), summ_table AS (     SELECT          n1."symbol" AS "symbol1",         n2."symbol" AS "symbol2",         COUNT(n1."ParticipantBarcode") AS "n",         CORR(n1."rnkdata", n2."rnkdata") AS "correlation"     FROM         table1 AS n1     INNER JOIN         table2 AS n2     ON         n1."ParticipantBarcode" = n2."ParticipantBarcode"     GROUP BY         "symbol1", "symbol2" )  SELECT      "symbol1",      "symbol2",      ABS("correlation") * SQRT(( "n" - 2 ) / (1 - "correlation" * "correlation")) AS "t" FROM      summ_table WHERE      "n" > 25      AND ABS("correlation") >= 0.3      AND ABS("correlation") < 1.0;