# [Question]: Considering only the latest release versions of NPM package, which packages are the top 8 most popular based on the Github star number, as well as their versions?
# [Schema links]: ["DEPS_DEV_V1.PACKAGEVERSIONS.Name", "DEPS_DEV_V1.PACKAGEVERSIONS.Version", "DEPS_DEV_V1.PACKAGEVERSIONS.VersionInfo", "DEPS_DEV_V1.PACKAGEVERSIONS.System", "DEPS_DEV_V1.PACKAGEVERSIONTOPROJECT.Name", "DEPS_DEV_V1.PACKAGEVERSIONTOPROJECT.Version", "DEPS_DEV_V1.PACKAGEVERSIONTOPROJECT.ProjectType", "DEPS_DEV_V1.PACKAGEVERSIONTOPROJECT.ProjectName", "DEPS_DEV_V1.PACKAGEVERSIONTOPROJECT.System", "DEPS_DEV_V1.PROJECTS.StarsCount", "DEPS_DEV_V1.PROJECTS.Name"]
# [Analysis]: Letâ€™s think step by step.
1. Identify the relevant tables: `DEPS_DEV_V1.PACKAGEVERSIONS` (contains package versions and release info), `DEPS_DEV_V1.PACKAGEVERSIONTOPROJECT` (links packages to projects), and `DEPS_DEV_V1.PROJECTS` (contains GitHub star counts).
2. Filter `PACKAGEVERSIONS` to select only NPM packages with release versions by checking `"System" = 'NPM'` and `TO_BOOLEAN(PARSE_JSON("VersionInfo"):"IsRelease") = TRUE`.
3. For each package name in `PACKAGEVERSIONS`, determine the latest release version using `ROW_NUMBER()` partitioned by `"Name"` and ordered by `TO_NUMBER(PARSE_JSON("VersionInfo"):"Ordinal") DESC`.
4. Create a CTE `HighestReleases` to store the latest release versions (name and version) where `RowNumber = 1`.
5. Join `HighestReleases` with `PACKAGEVERSIONTOPROJECT` on `"Name"` and `"Version"` to link to project data, filtering for `"System" = 'NPM'` and `"ProjectType" = 'GITHUB'`.
6. Join the result with `PROJECTS` on `"ProjectName" = "Name"` to retrieve the `StarsCount`.
7. Sort the joined results by `StarsCount` in descending order and limit to the top 8 records.
8. Select the required columns (`Name`, `Version`, `StarsCount`) from the final joined and sorted dataset.
# [Sql]: WITH HighestReleases AS (     SELECT         HR."Name",         HR."Version"     FROM (         SELECT             "Name",             "Version",             ROW_NUMBER() OVER (                 PARTITION BY "Name"                 ORDER BY                      TO_NUMBER(PARSE_JSON("VersionInfo"):"Ordinal") DESC             ) AS RowNumber         FROM             DEPS_DEV_V1.DEPS_DEV_V1.PACKAGEVERSIONS         WHERE             "System" = 'NPM'             AND TO_BOOLEAN(PARSE_JSON("VersionInfo"):"IsRelease") = TRUE     ) AS HR     WHERE HR.RowNumber = 1 ), PVP AS (     SELECT         PVP."Name",          PVP."Version",          PVP."ProjectType",          PVP."ProjectName"     FROM         DEPS_DEV_V1.DEPS_DEV_V1.PACKAGEVERSIONTOPROJECT AS PVP     JOIN         HighestReleases AS HR     ON         PVP."Name" = HR."Name"         AND PVP."Version" = HR."Version"     WHERE         PVP."System" = 'NPM'         AND PVP."ProjectType" = 'GITHUB' ) SELECT     PVP."Name",      PVP."Version",     P."StarsCount" FROM     PVP JOIN     DEPS_DEV_V1.DEPS_DEV_V1.PROJECTS AS P ON     PVP."ProjectName" = P."Name" ORDER BY     P."StarsCount" DESC LIMIT 8;