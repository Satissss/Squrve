# [Question]: What are the top 5 zip codes of the areas in the United States that have experienced the most hail storm events in the past 10 years? Don't use data from hail reports table.
# [Schema links]: ['STORMS_2014.event_id', 'STORMS_2014.event_type', 'STORMS_2014.event_point', 'ZIP_CODES.zip_code_geom', 'ZIP_CODES.zip_code', 'ZIP_CODES.city', 'ZIP_CODES.state_name']
# [Analysis]: # Output: Letâ€™s think step by step.
1. Identify the relevant tables: multiple `STORMS_20XX` tables for each year (2014-2024) and the `ZIP_CODES` table.
2. Combine all storm data from 2014 to 2024 using `UNION ALL` to create a single dataset of storm events.
3. Filter the combined storm data to include only hail events by checking `event_type = 'hail'`.
4. Use spatial functions to join storm events to zip codes: `ST_WITHIN(ST_GEOGFROMWKB(event_point), ST_GEOGFROMWKB(zip_code_geom))` ensures each storm event is assigned to the zip code where it occurred.
5. Group the results by `zip_code`, `city`, and `state_name` to count the number of hail events per zip code.
6. Count the number of hail events (`event_id`) for each zip code to determine the frequency.
7. Order the results by the count of storms in descending order to get the areas with the most hail events.
8. Limit the output to the top 5 zip codes using `LIMIT 5`.
9. Format the output to include the city and state concatenated, the zip code, and the count of storms.
# [Sql]: SELECT   CONCAT("city", ', ', "state_name") AS "city",   "zip_code",   COUNT("event_id") AS "count_storms" FROM (     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2014     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2015     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2016     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2017     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2018     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2019     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2020     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2021     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2022     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2023     UNION ALL     SELECT *     FROM NOAA_DATA_PLUS.NOAA_HISTORIC_SEVERE_STORMS.STORMS_2024 ) AS storms JOIN NOAA_DATA_PLUS.GEO_US_BOUNDARIES.ZIP_CODES   ON ST_WITHIN(ST_GEOGFROMWKB(storms."event_point"), ST_GEOGFROMWKB("zip_code_geom")) WHERE    LOWER(storms."event_type") = 'hail' GROUP BY   "zip_code",    "city",    "state_name" ORDER BY   "count_storms" DESC LIMIT 5;